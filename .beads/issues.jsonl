{"id":"swift-package-generator-based-on-openapi-08g","title":"Write tests for Op3: nullable to 3.1 format","description":"Write pytest tests for Op3 transformation. Test cases: (1) nullable:true in OpenAPI \u003c3.1.0 converted to 3.1 format (oneOf or type array), (2) check OpenAPI version detection, (3) handle different type combinations. Research which nullability pattern Swift OpenAPIGenerator prefers. TDD approach.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T18:07:46.454803+01:00","updated_at":"2025-12-12T19:02:16.14082+01:00","closed_at":"2025-12-12T19:02:16.14082+01:00"}
{"id":"swift-package-generator-based-on-openapi-1o2","title":"Implement writer.py for JSON/YAML output","description":"Implement src/bootstrapper/core/writer.py with write_spec(data: dict, path: Path, format: FileFormat) function. Must write to openapi.yaml or openapi.json matching original format. CRITICAL: Configure PyYAML to avoid creating aliases/anchors that Swift parser doesn't support. See plan section 5.2.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-12T18:07:45.181271+01:00","updated_at":"2025-12-12T18:34:14.752055+01:00","closed_at":"2025-12-12T18:34:14.752055+01:00"}
{"id":"swift-package-generator-based-on-openapi-1wo","title":"Implement Swift package scaffolding (swift.py)","description":"Implement src/bootstrapper/generators/swift.py using subprocess.run. (1) Check for Package.swift, (2) If missing: generate Package.swift via Jinja2 template with all deps (OpenAPI runtime, AsyncHTTPClient, etc) instead of running swift package add-dependency commands, (3) Create Sources/{Name}Types and Sources/{Name}Client dirs, (4) Run swift-openapi-generator. See plan section 5.4.2.","notes":"swift.py implementation complete with 36 passing tests. Package structure creation, generation and scaffolding fully implemented. Also created Package.swift.j2 template with all dependencies.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T18:07:48.589898+01:00","updated_at":"2025-12-12T20:48:47.359636+01:00","closed_at":"2025-12-12T20:48:47.35964+01:00"}
{"id":"swift-package-generator-based-on-openapi-2p8","title":"Setup project structure with uv and dependencies","description":"Initialize Python project using uv. Create directory structure per plan (src/bootstrapper with core/, transformers/, generators/, resources/ subdirs). Install dependencies: Typer, Rich, PyYAML, Jinja2, Pydantic. Setup pyproject.toml, add Ruff and Pytest. See history/initial_plan.md sections 2-4.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-12T18:07:44.778468+01:00","updated_at":"2025-12-12T18:28:04.106595+01:00","closed_at":"2025-12-12T18:28:04.106595+01:00"}
{"id":"swift-package-generator-based-on-openapi-4qa","title":"Mark test_swift_files_allow_build with @pytest.mark.slow","description":"## Goal\nMark the slow Swift build test so it's skipped by default.\n\n## Changes Required\nEdit `tests/test_swift.py` line 638, add `@pytest.mark.slow` decorator:\n\n```python\n@pytest.mark.slow\n@pytest.mark.skipif(\n    not Path(\"/usr/bin/swift\").exists() and not Path(\"/usr/local/bin/swift\").exists(),\n    reason=\"Swift toolchain not available\",\n)\ndef test_swift_files_allow_build(self):\n    \"\"\"Verify swift build succeeds with just initial files...\"\"\"\n```\n\n## Why This Test is Slow\nThis test actually runs `swift build` which:\n- Downloads/resolves Swift dependencies\n- Compiles the package\n- Can take 30+ seconds\n\n## File\n- `tests/test_swift.py` (line 638)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-13T21:30:01.001289+01:00","updated_at":"2025-12-13T21:30:08.213587+01:00","dependencies":[{"issue_id":"swift-package-generator-based-on-openapi-4qa","depends_on_id":"swift-package-generator-based-on-openapi-clk","type":"blocks","created_at":"2025-12-13T21:30:01.002257+01:00","created_by":"daemon"}]}
{"id":"swift-package-generator-based-on-openapi-54h","title":"Create AuthenticationMiddleware.swift.j2 template","description":"Create Jinja2 template for generating Swift authentication middleware with support for Bearer tokens and API Key authentication.\n\n## Context\nGenerate AuthenticationMiddleware.swift files that inject authentication into HTTP requests. Content varies based on OpenAPI security scheme type.\n\n## Template Location\nsrc/bootstrapper/resources/AuthenticationMiddleware.swift.j2\n\n## Template Structure\nSingle template with Jinja2 conditionals for two variants:\n\n```swift\n// AuthenticationMiddleware.swift\n// Auto-generated by swift-openapi-bootstrapper\n// Security Scheme: {{ scheme_name }}\n\nimport Foundation\nimport OpenAPIRuntime\nimport HTTPTypes\n\npublic struct AuthenticationMiddleware: ClientMiddleware {\n    public var apiKey: String\n\n    public init(apiKey: String) {\n        self.apiKey = apiKey\n    }\n\n    public func intercept(\n        _ request: HTTPRequest,\n        body: HTTPBody?,\n        baseURL: URL,\n        operationID: String,\n        next: (HTTPRequest, HTTPBody?, URL) async throws -\u003e (HTTPResponse, HTTPBody?)\n    ) async throws -\u003e (HTTPResponse, HTTPBody?) {\n        var request = request\n\n{% if scheme_type == \"http_bearer\" %}\n        // HTTP Bearer Token Authentication\n        request.headerFields[.authorization] = \"Bearer \\(apiKey)\"\n{% elif scheme_type == \"api_key_header\" %}\n        // API Key in Header Authentication\n        if let httpFieldName = HTTPField.Name(\"{{ header_name | lower }}\") {\n            request.headerFields[httpFieldName] = apiKey\n        }\n{% endif %}\n\n        return try await next(request, body, baseURL)\n    }\n}\n```\n\n## Template Context Variables\nThe template expects these variables from security.py:\n- **scheme_name**: Name of security scheme from OpenAPI (e.g., \"BearerAuth\")\n- **scheme_type**: String value (\"http_bearer\" or \"api_key_header\")\n- **header_name**: Actual header name for API Key (e.g., \"X-API-Key\", \"x-api-key\")\n\n## Key Features\n1. **Bearer Token Variant**: Uses standard Authorization header with \"Bearer\" prefix\n2. **API Key Variant**: Uses custom header name extracted from OpenAPI spec\n3. **Lowercase filter**: Ensures header names are lowercase for HTTPField.Name()\n4. **Conditional blocks**: Clean separation between the two authentication types\n\n## Requirements\n- Must use Jinja2 syntax\n- Include clear comments for each auth type\n- Use {{ header_name | lower }} filter for API Key headers\n- Include file header with scheme name for debugging\n\n## File to Create\n- src/bootstrapper/resources/AuthenticationMiddleware.swift.j2 (~40 lines)\n\n## Testing\nWill be tested indirectly through test_security.py when generating actual files","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-13T15:23:54.179818+01:00","updated_at":"2025-12-13T16:18:09.672766+01:00","closed_at":"2025-12-13T16:18:09.672766+01:00"}
{"id":"swift-package-generator-based-on-openapi-5zv","title":"Create comprehensive tests for security module (test_security.py)","description":"Create comprehensive test suite for the security module that extracts and classifies OpenAPI security schemes.\n\n## Context\nTest all functions in security.py including extraction, classification, and middleware generation with various OpenAPI spec scenarios.\n\n## Test File Location\ntests/test_security.py (~300-400 lines)\n\n## Test Classes to Implement\n\n### 1. TestExtractSecuritySchemes\nTest the extract_security_schemes() function:\n- **test_no_security_schemes**: Empty dict when no security\n- **test_no_components_section**: Empty dict when no components\n- **test_extract_bearer_scheme**: Correctly extract Bearer definition\n- **test_extract_api_key_scheme**: Correctly extract API Key with name field\n- **test_extract_multiple_schemes**: Return all schemes (dict with multiple entries)\n\n### 2. TestClassifySecurityScheme\nTest the classify_security_scheme() function:\n- **test_classify_bearer_token**: type=\"http\", scheme=\"bearer\" → HTTP_BEARER\n- **test_classify_api_key_header**: type=\"apiKey\", in=\"header\" → API_KEY_HEADER (extract name)\n- **test_classify_api_key_query_unsupported**: type=\"apiKey\", in=\"query\" → UNSUPPORTED\n- **test_classify_oauth2_unsupported**: type=\"oauth2\" → UNSUPPORTED\n- **test_classify_http_basic_unsupported**: type=\"http\", scheme=\"basic\" → UNSUPPORTED\n- **test_classify_openid_unsupported**: type=\"openIdConnect\" → UNSUPPORTED\n\n### 3. TestGetPrimarySecurityScheme\nTest the get_primary_security_scheme() function with real YAML files:\n- **test_no_security_schemes_returns_none**: Create spec without security → None\n- **test_bearer_scheme_returned**: Create spec with Bearer → SecurityScheme object\n- **test_api_key_scheme_returned**: Create spec with API Key → SecurityScheme with header_name\n- **test_first_scheme_selected_from_multiple**: Multiple schemes → first one returned\n- **test_unsupported_scheme_returns_none**: OAuth2 scheme → None\n- **test_invalid_file_returns_none**: Nonexistent file → None\n\n### 4. TestGenerateAuthenticationMiddleware\nTest the generate_authentication_middleware() function:\n- **test_generate_bearer_middleware**: \n  - Create OpenAPI with Bearer auth\n  - Call generation function\n  - Verify file created in Sources/{Project}Client/\n  - Verify content contains \"Bearer\" and \".authorization\"\n  - Verify return status {\"generated\": True}\n\n- **test_generate_api_key_middleware**:\n  - Create OpenAPI with API Key (name=\"X-Custom-Key\")\n  - Verify file created\n  - Verify content contains \"x-custom-key\" (lowercased)\n  - Verify content contains \"HTTPField.Name\"\n\n- **test_no_security_no_file_generated**:\n  - OpenAPI without security\n  - No file created\n  - Return {\"generated\": False, \"reason\": \"No supported security schemes\"}\n\n- **test_preserve_existing_file**:\n  - Create file with custom content\n  - Run generation\n  - Verify custom content preserved\n  - Return {\"generated\": False, \"reason\": \"already exists\"}\n\n- **test_openapi_file_not_found**:\n  - No OpenAPI file\n  - Return {\"generated\": False, \"reason\": \"not found\"}\n\n- **test_unsupported_scheme_no_generation**:\n  - OpenAPI with OAuth2\n  - No file created\n  - Return appropriate reason\n\n## Test Utilities\n- Use tempfile.TemporaryDirectory() for isolated test environments\n- Create OpenAPI YAML files using Path.write_text()\n- Use pytest for test framework\n- Follow existing test patterns from test_swift.py\n\n## Example Test Structure\n```python\ndef test_generate_bearer_middleware():\n    with tempfile.TemporaryDirectory() as tmpdir:\n        target_dir = Path(tmpdir)\n        \n        # Create OpenAPI spec\n        (target_dir / \"openapi.yaml\").write_text(\"\"\"\nopenapi: 3.1.0\ninfo:\n  title: Test API\n  version: 1.0.0\ncomponents:\n  securitySchemes:\n    BearerAuth:\n      type: http\n      scheme: bearer\npaths: {}\n        \"\"\".strip())\n        \n        # Create Client directory\n        client_dir = target_dir / \"Sources\" / \"TestProjectClient\"\n        client_dir.mkdir(parents=True)\n        \n        # Generate middleware\n        result = generate_authentication_middleware(target_dir, \"TestProject\")\n        \n        assert result[\"generated\"] is True\n        assert \"http bearer\" in result[\"reason\"].lower()\n        \n        # Verify file and content\n        auth_file = client_dir / \"AuthenticationMiddleware.swift\"\n        assert auth_file.exists()\n        content = auth_file.read_text()\n        assert \"Bearer\" in content\n        assert \".authorization\" in content\n```\n\n## Verification\nRun tests with:\n```bash\nuv run pytest tests/test_security.py -v\n```\n\nAll tests must pass before marking issue complete.\n\n## File to Create\n- tests/test_security.py (~300-400 lines)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-13T15:24:43.653254+01:00","updated_at":"2025-12-13T16:22:45.425812+01:00","closed_at":"2025-12-13T16:22:45.425812+01:00","dependencies":[{"issue_id":"swift-package-generator-based-on-openapi-5zv","depends_on_id":"swift-package-generator-based-on-openapi-dsd","type":"blocks","created_at":"2025-12-13T15:24:43.653893+01:00","created_by":"daemon"}]}
{"id":"swift-package-generator-based-on-openapi-7js","title":"Implement Op5: clean required array transformer","description":"Implement src/bootstrapper/transformers/op5_clean_required.py. Logic: For each Schema Object, get properties keys and required array. Filter required to only include keys that exist in properties: [k for k in required if k in properties]. Needs parent context from walker. Must pass tests from dim. See plan section 5.3 Operation 5.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T18:07:47.593884+01:00","updated_at":"2025-12-12T19:07:48.117585+01:00","closed_at":"2025-12-12T19:07:48.117585+01:00","dependencies":[{"issue_id":"swift-package-generator-based-on-openapi-7js","depends_on_id":"swift-package-generator-based-on-openapi-dim","type":"blocks","created_at":"2025-12-12T18:10:31.839312+01:00","created_by":"daemon"},{"issue_id":"swift-package-generator-based-on-openapi-7js","depends_on_id":"swift-package-generator-based-on-openapi-dhi","type":"blocks","created_at":"2025-12-12T18:10:31.88473+01:00","created_by":"daemon"}]}
{"id":"swift-package-generator-based-on-openapi-7x1","title":"Add CLI reporting for initial Swift file creation (optional)","description":"Update the CLI output in src/bootstrapper/main.py to report when initial Swift files are created during bootstrapping.\n\n## Context\nThis is an optional enhancement to provide user feedback when Swift files are created. It improves the user experience by showing what the tool is doing.\n\n## Implementation\nIn main.py, after the call to ensure_package_structure(), add:\n\n```python\n# Report Swift file creation\nif any([\n    structure_results.get(\"types_file\"),\n    structure_results.get(\"client_file\"),\n    structure_results.get(\"tests_file\")\n]):\n    console.print(\"[bold green]✓[/bold green] Created initial Swift files\")\n```\n\n## Location\nAdd this reporting after ensure_package_structure() is called but before other status messages.\n\n## User Experience\nWhen running swift-bootstrapper for the first time:\n```\n✓ Package.swift generated\n✓ Created initial Swift files          ← NEW\n✓ Created configuration files\n...\n```\n\nOn subsequent runs (files already exist):\n```\n✓ Package.swift exists\n✓ Created configuration files\n...\n```\n\nThe message only appears when at least one Swift file is created (not on updates where files already exist).\n\n## Alternative Messages (Choose One)\n- \"Created initial Swift files\" (simple)\n- \"Created placeholder Swift files for targets\" (descriptive)\n- \"Generated initial Swift files to satisfy SPM\" (technical)\n\nRecommend: \"Created initial Swift files\" for brevity.\n\n## Testing\nManually test:\n1. Bootstrap a new project - verify message appears\n2. Re-run bootstrap - verify message doesn't appear\n3. Delete one Swift file and re-run - verify message appears\n\n## File to Modify\n- src/bootstrapper/main.py\n\n## Priority\nPriority 2 (nice to have) - this is purely cosmetic and doesn't affect functionality.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-13T14:50:57.346051+01:00","updated_at":"2025-12-13T19:18:59.729895+01:00","closed_at":"2025-12-13T19:18:59.729895+01:00","dependencies":[{"issue_id":"swift-package-generator-based-on-openapi-7x1","depends_on_id":"swift-package-generator-based-on-openapi-9pk","type":"blocks","created_at":"2025-12-13T14:50:57.346821+01:00","created_by":"daemon"}]}
{"id":"swift-package-generator-based-on-openapi-8el","title":"Write tests for Op2: const to enum conversion","description":"Write pytest tests for Op2 transformation. Test cases: (1) const value is converted to enum array with single value, (2) const key is removed, (3) works with string/number/boolean const values. Use OpenAPI schema snippets. TDD approach - write tests first.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T18:07:46.020577+01:00","updated_at":"2025-12-12T18:59:58.561238+01:00","closed_at":"2025-12-12T18:59:58.561238+01:00"}
{"id":"swift-package-generator-based-on-openapi-8jg","title":"Update AGENTS.md with slow test documentation","description":"## Goal\nDocument how to run slow tests in the verification checklist.\n\n## Changes Required\nUpdate the \"Code Verification\" section in `AGENTS.md`. Modify the \"Run Tests\" step:\n\n```markdown\n2. **Run Tests**: Execute the test suite\n   ```bash\n   uv run pytest\n   ```\n\n   To include slow tests (e.g., swift build verification):\n   ```bash\n   uv run pytest -m \"\"\n   ```\n```\n\n## Context\n- Slow tests are skipped by default to speed up the development cycle\n- The swift build test (`test_swift_files_allow_build`) verifies generated Package.swift compiles\n- Only run slow tests when changes affect Swift package generation\n\n## File\n- `AGENTS.md`","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-13T21:30:12.269413+01:00","updated_at":"2025-12-13T21:30:19.251184+01:00","dependencies":[{"issue_id":"swift-package-generator-based-on-openapi-8jg","depends_on_id":"swift-package-generator-based-on-openapi-clk","type":"blocks","created_at":"2025-12-13T21:30:12.270244+01:00","created_by":"daemon"}]}
{"id":"swift-package-generator-based-on-openapi-8ta","title":"Implement Op4: format byte to contentEncoding","description":"Implement src/bootstrapper/transformers/op4_format_fix.py. Logic: Check OpenAPI version \u003e=3.1.0, find {type:string, format:byte}, replace with {type:string, contentEncoding:base64}. Handles OpenAPI 3.1 spec compliance. Must pass tests from hc8. See plan section 5.3 Operation 4.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T18:07:47.135156+01:00","updated_at":"2025-12-12T19:05:09.750656+01:00","closed_at":"2025-12-12T19:05:09.750656+01:00","dependencies":[{"issue_id":"swift-package-generator-based-on-openapi-8ta","depends_on_id":"swift-package-generator-based-on-openapi-hc8","type":"blocks","created_at":"2025-12-12T18:10:31.656886+01:00","created_by":"daemon"},{"issue_id":"swift-package-generator-based-on-openapi-8ta","depends_on_id":"swift-package-generator-based-on-openapi-dhi","type":"blocks","created_at":"2025-12-12T18:10:31.702361+01:00","created_by":"daemon"}]}
{"id":"swift-package-generator-based-on-openapi-9pk","title":"Integrate create_initial_swift_files() into ensure_package_structure()","description":"Modify the ensure_package_structure() function in src/bootstrapper/generators/swift.py to call create_initial_swift_files() and include the results in its return dict.\n\n## Context\nAfter creating the target directories, we need to create initial Swift files before the .gitkeep files. This ensures swift build succeeds before code generation.\n\n## Current Flow (lines 14-72)\n1. Create Package.swift if doesn't exist\n2. Create directories (Types, Client, Tests)\n3. Create .gitkeep files\n4. Return results\n\n## New Flow\n1. Create Package.swift if doesn't exist\n2. Create directories (Types, Client, Tests)\n3. **Create initial Swift files (NEW)**\n4. Create .gitkeep files (can coexist with Swift files)\n5. Return enhanced results\n\n## Implementation\nAdd after line 63 (after directories are created):\n\n```python\n# Create initial Swift files to satisfy Swift Package Manager\nswift_file_results = create_initial_swift_files(target_dir, project_name)\nresults.update(swift_file_results)\n```\n\nThe .gitkeep creation logic can remain unchanged - .gitkeep files can coexist with Swift files.\n\n## Updated Return Type\nThe function should now return a dict with these keys:\n```python\n{\n    \"package_swift\": bool,\n    \"types_dir\": bool,\n    \"client_dir\": bool,\n    \"tests_dir\": bool,\n    \"types_file\": bool,      # NEW\n    \"client_file\": bool,     # NEW\n    \"tests_file\": bool,      # NEW\n}\n```\n\n## Update Docstring\nUpdate the docstring's Returns section to document the three new keys in the return dict.\n\n## File to Modify\n- src/bootstrapper/generators/swift.py (modify ensure_package_structure() function at line 14)\n\n## Testing\nAfter implementation, verify:\n1. Swift files are created when running ensure_package_structure()\n2. Return dict includes the new keys\n3. swift build succeeds with just the initial files (before code generation)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-13T14:50:22.228481+01:00","updated_at":"2025-12-13T16:15:10.121527+01:00","closed_at":"2025-12-13T16:15:10.121527+01:00","dependencies":[{"issue_id":"swift-package-generator-based-on-openapi-9pk","depends_on_id":"swift-package-generator-based-on-openapi-tfp","type":"blocks","created_at":"2025-12-13T14:50:22.229153+01:00","created_by":"daemon"}]}
{"id":"swift-package-generator-based-on-openapi-ae3","title":"Implement Op1: null anyOf removal transformer","description":"Implement src/bootstrapper/transformers/op1_null_anyof.py. Logic: Find all 'anyOf' arrays, remove {type: null} entries, unwrap anyOf if only 1 item remains, remove 'default: null' if type no longer nullable. Use ops_base recursive_walk. Must pass all tests from issue zve. See plan section 5.3 Operation 1.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T18:07:45.799525+01:00","updated_at":"2025-12-12T18:58:27.014679+01:00","closed_at":"2025-12-12T18:58:27.014679+01:00","dependencies":[{"issue_id":"swift-package-generator-based-on-openapi-ae3","depends_on_id":"swift-package-generator-based-on-openapi-zve","type":"blocks","created_at":"2025-12-12T18:10:31.081522+01:00","created_by":"daemon"},{"issue_id":"swift-package-generator-based-on-openapi-ae3","depends_on_id":"swift-package-generator-based-on-openapi-dhi","type":"blocks","created_at":"2025-12-12T18:10:31.135299+01:00","created_by":"daemon"}]}
{"id":"swift-package-generator-based-on-openapi-apd","title":"Update main.py to apply overlay after config generation","description":"## Context\nIntegrate overlay application into the CLI bootstrap workflow. The overlay should be applied:\n1. After `generate_config_files()` (ensures overlay file exists)\n2. Before `run_openapi_generator()` (so generated code uses the overlaid spec)\n\n## Changes Required\n\n### 1. Add Import\n```python\nfrom bootstrapper.transformers.op6_overlay import apply_overlay\n```\n\n### 2. Pass file format to generate_config_files()\n```python\nconfig_results = generate_config_files(\n    target_path, project_name, file_format=original_openapi.suffix\n)\n```\n\n### 3. Add overlay application step\nInsert after config file generation, before security analysis:\n\n```python\n# Step 3.6: Apply overlay if it exists and has actions\nwith console.status(\"[bold yellow]Applying overlay...\"):\n    try:\n        overlay_results = apply_overlay(target_path, openapi_file=output_file.name)\n    except Exception as e:\n        console.print(f\"[bold red]✗[/bold red] Failed to apply overlay: {e}\")\n        raise typer.Exit(1)\n\n# Report results (only show if applied or failed, silent skip for empty overlay)\nif overlay_results[\"applied\"]:\n    console.print(f\"[bold green]✓[/bold green] {overlay_results['reason']}\")\nelif not overlay_results[\"skipped\"]:\n    # Only show warning if it was attempted but failed\n    console.print(f\"[bold yellow]![/bold yellow] Overlay: {overlay_results['reason']}\")\n# Silent skip when overlay has no actions (normal/expected case)\n```\n\n## Console Output Examples\n\n### Overlay Applied\n```\n✓ Applied 3 overlay action(s)\n```\n\n### No Overlay Actions (Silent)\n(No output - normal first-run behavior)\n\n### openapi-format Not Installed\n```\n! Overlay: openapi-format CLI not found. Install with: npm install -g openapi-format\n```\n\n## File to Modify\n- `src/bootstrapper/main.py` (add import, modify generate_config_files call, add overlay step)","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-13T21:24:06.901105+01:00","updated_at":"2025-12-13T21:24:06.901105+01:00","dependencies":[{"issue_id":"swift-package-generator-based-on-openapi-apd","depends_on_id":"swift-package-generator-based-on-openapi-fpo","type":"blocks","created_at":"2025-12-13T21:24:06.901723+01:00","created_by":"daemon"},{"issue_id":"swift-package-generator-based-on-openapi-apd","depends_on_id":"swift-package-generator-based-on-openapi-dmp","type":"blocks","created_at":"2025-12-13T21:24:06.902156+01:00","created_by":"daemon"}]}
{"id":"swift-package-generator-based-on-openapi-bi5","title":"Implement template rendering system","description":"Implement src/bootstrapper/generators/templates.py using Jinja2 to render config files. Load templates from resources/, render with context (project name, etc), write to target directory only if files don't exist (preserve user edits on updates). See plan section 5.4.1.","notes":"Implemented template rendering system with comprehensive test suite covering all functions and edge cases. All 38 tests pass.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T18:07:48.326244+01:00","updated_at":"2025-12-12T20:11:22.36067+01:00","closed_at":"2025-12-12T20:11:22.36067+01:00","dependencies":[{"issue_id":"swift-package-generator-based-on-openapi-bi5","depends_on_id":"swift-package-generator-based-on-openapi-d3i","type":"blocks","created_at":"2025-12-12T18:10:32.353961+01:00","created_by":"daemon"}]}
{"id":"swift-package-generator-based-on-openapi-clk","title":"Add pytest 'slow' marker configuration to pyproject.toml","description":"## Goal\nConfigure pytest to support a 'slow' marker for tests that take a long time (e.g., swift build tests).\n\n## Changes Required\nEdit `pyproject.toml` and update the `[tool.pytest.ini_options]` section:\n\n```toml\n[tool.pytest.ini_options]\ntestpaths = [\"tests\"]\npython_files = \"test_*.py\"\nmarkers = [\n    \"slow: marks tests as slow (deselect with '-m \\\"not slow\\\"')\",\n]\naddopts = \"-m 'not slow'\"\n```\n\n## Result\n- Slow tests are skipped by default when running `uv run pytest`\n- To include slow tests: `uv run pytest -m \\\"\\\"`\n\n## File\n- `pyproject.toml`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-13T21:29:49.762704+01:00","updated_at":"2025-12-13T21:42:13.772601+01:00","closed_at":"2025-12-13T21:42:13.772601+01:00"}
{"id":"swift-package-generator-based-on-openapi-d16","title":"Implement main CLI with Typer","description":"Implement src/bootstrapper/main.py as Typer CLI entry point. Command: 'bootstrap [target_dir]'. Workflow: (1) Init rich.console, (2) Find original_openapi.yaml/json, (3) Call transformers.manager.process_spec(), (4) Call generators.swift.ensure_package_structure(), (5) Call generators.swift.run_generator(). Beautiful terminal output with spinners/checkmarks. See plan sections 5.1 and 8, user manual section 2-4.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T18:07:48.83962+01:00","updated_at":"2025-12-12T21:21:38.786861+01:00","closed_at":"2025-12-12T21:21:38.786861+01:00","dependencies":[{"issue_id":"swift-package-generator-based-on-openapi-d16","depends_on_id":"swift-package-generator-based-on-openapi-dut","type":"blocks","created_at":"2025-12-12T18:10:32.497076+01:00","created_by":"daemon"},{"issue_id":"swift-package-generator-based-on-openapi-d16","depends_on_id":"swift-package-generator-based-on-openapi-1wo","type":"blocks","created_at":"2025-12-12T18:10:32.541154+01:00","created_by":"daemon"},{"issue_id":"swift-package-generator-based-on-openapi-d16","depends_on_id":"swift-package-generator-based-on-openapi-bi5","type":"blocks","created_at":"2025-12-12T18:10:32.58568+01:00","created_by":"daemon"},{"issue_id":"swift-package-generator-based-on-openapi-d16","depends_on_id":"swift-package-generator-based-on-openapi-pbj","type":"blocks","created_at":"2025-12-12T18:10:32.629629+01:00","created_by":"daemon"},{"issue_id":"swift-package-generator-based-on-openapi-d16","depends_on_id":"swift-package-generator-based-on-openapi-1o2","type":"blocks","created_at":"2025-12-12T18:10:32.673338+01:00","created_by":"daemon"}]}
{"id":"swift-package-generator-based-on-openapi-d3i","title":"Create Jinja2 templates for all config files","description":"Create Jinja2 templates in src/bootstrapper/resources/: (1) Makefile.j2 with swift run commands, (2) .gitignore.j2, (3) .env.example.j2 for API keys, (4) openapi-generator-config.yaml.j2 for Types+Client configs, (5) overlay.yaml.j2 minimal empty overlay. Use template variables for project name. See plan sections 5.4.1 and 6.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T18:07:48.076594+01:00","updated_at":"2025-12-12T19:33:03.539199+01:00","closed_at":"2025-12-12T19:33:03.539199+01:00"}
{"id":"swift-package-generator-based-on-openapi-dhi","title":"Implement ops_base.py recursive walker","description":"Implement src/bootstrapper/transformers/ops_base.py with recursive_walk(data, transform_func, parent=None, key_in_parent=None) helper. Must traverse all dict/list structures in OpenAPI spec, calling transform_func at each node. Handle in-place modifications. This is the foundation for all transformation operations. See plan section 5.3 and code snippet in section 9.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-12T18:07:45.380194+01:00","updated_at":"2025-12-12T18:34:40.281159+01:00","closed_at":"2025-12-12T18:34:40.281159+01:00"}
{"id":"swift-package-generator-based-on-openapi-dim","title":"Write tests for Op5: clean required array","description":"Write pytest tests for Op5 transformation. Test cases: (1) required array filtered to only include keys in properties, (2) nonexistent properties removed from required, (3) empty required array handled, (4) nested schema objects processed. TDD approach.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T18:07:47.364595+01:00","updated_at":"2025-12-12T19:06:01.42666+01:00","closed_at":"2025-12-12T19:06:01.42666+01:00"}
{"id":"swift-package-generator-based-on-openapi-dmp","title":"Create op6_overlay.py transformer to apply overlays via openapi-format CLI","description":"## Context\nApply OpenAPI overlays using the external `openapi-format` CLI tool. This is a transformation step that runs after Python-based transformations (Op1-5).\n\n## Command\n```bash\nopenapi-format --no-sort ./openapi.yaml --overlayFile openapi-overlay.yaml -o ./openapi.yaml\n```\n\n## File to Create\n`src/bootstrapper/transformers/op6_overlay.py`\n\n## Function Signature\n```python\ndef apply_overlay(\n    target_dir: Path,\n    openapi_file: str = \"openapi.yaml\",\n) -\u003e dict[str, bool | str]:\n    \"\"\"Apply OpenAPI overlay using openapi-format CLI.\n\n    Args:\n        target_dir: Directory containing the OpenAPI files\n        openapi_file: Name of the OpenAPI spec file (e.g., \"openapi.yaml\" or \"openapi.json\")\n\n    Returns:\n        Dictionary with:\n        - \"applied\": True if overlay was applied successfully\n        - \"skipped\": True if skipped (no overlay or empty actions)\n        - \"reason\": Description of what happened\n    \"\"\"\n```\n\n## Implementation Logic\n1. Derive overlay filename from openapi_file extension:\n   - `openapi.yaml` → `openapi-overlay.yaml`\n   - `openapi.json` → `openapi-overlay.json`\n2. Check if overlay file exists → skip if not\n3. Parse overlay file (YAML or JSON) and check `actions` array\n4. Skip if `actions` is empty (normal first-run case)\n5. Run `openapi-format` via subprocess\n6. Handle errors:\n   - FileNotFoundError → helpful message about installing openapi-format\n   - TimeoutExpired → timeout error\n   - Non-zero exit → include stderr\n7. Return detailed status dict\n\n## Error Handling\nIf `openapi-format` is not installed:\n```python\nreturn {\n    \"applied\": False,\n    \"skipped\": False,\n    \"reason\": \"openapi-format CLI not found. Install with: npm install -g openapi-format\",\n}\n```\n\n## Dependencies\n- Uses subprocess for CLI execution\n- Uses yaml (PyYAML) for parsing YAML overlays\n- Uses json for parsing JSON overlays","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-13T21:23:53.551638+01:00","updated_at":"2025-12-13T21:23:53.551638+01:00"}
{"id":"swift-package-generator-based-on-openapi-dsd","title":"Create security.py module for OpenAPI security scheme extraction","description":"Create src/bootstrapper/generators/security.py to extract and classify security schemes from OpenAPI specifications.\n\n## Context\nGenerate AuthenticationMiddleware.swift based on security schemes in OpenAPI specs. This module provides the core logic to detect whether the API uses Bearer tokens, API Keys, or other auth methods.\n\n## Components to Implement\n\n### 1. SecuritySchemeType Enum\n```python\nclass SecuritySchemeType(Enum):\n    HTTP_BEARER = \"http_bearer\"\n    API_KEY_HEADER = \"api_key_header\"\n    UNSUPPORTED = \"unsupported\"\n```\n\n### 2. SecurityScheme Class\n```python\nclass SecurityScheme:\n    def __init__(self, name: str, scheme_type: SecuritySchemeType, header_name: Optional[str] = None):\n        self.name = name\n        self.scheme_type = scheme_type\n        self.header_name = header_name  # For API Key auth\n```\n\n### 3. extract_security_schemes()\nExtract security schemes from components.securitySchemes path:\n```python\ndef extract_security_schemes(spec: dict) -\u003e dict[str, dict]:\n    return spec.get(\"components\", {}).get(\"securitySchemes\", {})\n```\n\n### 4. classify_security_scheme()\nClassify scheme into HTTP_BEARER, API_KEY_HEADER, or UNSUPPORTED:\n- `type=\"http\" AND scheme=\"bearer\"` → HTTP_BEARER\n- `type=\"apiKey\" AND in=\"header\"` → API_KEY_HEADER (extract name field)\n- Everything else → UNSUPPORTED (OAuth2, OpenID, API key in query/cookie, HTTP Basic)\n\n### 5. get_primary_security_scheme()\nMain entry point:\n1. Load OpenAPI spec using loader.load_spec()\n2. Extract security schemes\n3. Take first scheme (dict order preserved in Python 3.7+)\n4. Classify and return only if supported\n5. Return None if no schemes or unsupported\n\n### 6. generate_authentication_middleware()\nGenerate the Swift file:\n1. Check OpenAPI file exists\n2. Extract primary security scheme\n3. Return {\"generated\": False} if None\n4. Prepare template context (scheme_name, scheme_type, header_name)\n5. Render template using render_template()\n6. Write to Sources/{ProjectName}Client/AuthenticationMiddleware.swift\n7. Use write_if_not_exists() to preserve user edits\n8. Return detailed status dict\n\n## Requirements\n- Import from bootstrapper.core.loader for load_spec()\n- Import from bootstrapper.generators.templates for render_template() and write_if_not_exists()\n- Handle edge cases (missing files, malformed specs, no security)\n- Return detailed status for user feedback\n\n## File to Create\n- src/bootstrapper/generators/security.py (~150-200 lines)\n\n## Testing\nWill be tested by test_security.py (separate issue)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-13T15:23:36.811608+01:00","updated_at":"2025-12-13T16:09:45.836056+01:00","closed_at":"2025-12-13T16:09:45.836056+01:00"}
{"id":"swift-package-generator-based-on-openapi-dut","title":"Implement transformation manager to orchestrate operations","description":"Implement src/bootstrapper/transformers/manager.py to orchestrate all operations. Chain ops: spec = load() -\u003e Op1.apply() -\u003e Op2.apply() -\u003e Op3.apply() -\u003e Op4.apply() -\u003e Op5.apply() -\u003e save(). Coordinate the full transformation pipeline. See plan section 5.3 manager.py.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T18:07:47.834632+01:00","updated_at":"2025-12-12T19:26:50.406677+01:00","closed_at":"2025-12-12T19:26:50.406677+01:00","dependencies":[{"issue_id":"swift-package-generator-based-on-openapi-dut","depends_on_id":"swift-package-generator-based-on-openapi-ae3","type":"blocks","created_at":"2025-12-12T18:10:32.036899+01:00","created_by":"daemon"},{"issue_id":"swift-package-generator-based-on-openapi-dut","depends_on_id":"swift-package-generator-based-on-openapi-ek8","type":"blocks","created_at":"2025-12-12T18:10:32.08151+01:00","created_by":"daemon"},{"issue_id":"swift-package-generator-based-on-openapi-dut","depends_on_id":"swift-package-generator-based-on-openapi-r44","type":"blocks","created_at":"2025-12-12T18:10:32.125282+01:00","created_by":"daemon"},{"issue_id":"swift-package-generator-based-on-openapi-dut","depends_on_id":"swift-package-generator-based-on-openapi-8ta","type":"blocks","created_at":"2025-12-12T18:10:32.169752+01:00","created_by":"daemon"},{"issue_id":"swift-package-generator-based-on-openapi-dut","depends_on_id":"swift-package-generator-based-on-openapi-7js","type":"blocks","created_at":"2025-12-12T18:10:32.213907+01:00","created_by":"daemon"}]}
{"id":"swift-package-generator-based-on-openapi-ebl","title":"Integrate AuthenticationMiddleware generation into main.py","description":"Integrate generate_authentication_middleware() into the CLI bootstrap workflow in src/bootstrapper/main.py.\n\n## Context\nAfter package structure is created and before OpenAPI code generation, analyze the OpenAPI spec for security schemes and generate AuthenticationMiddleware.swift if applicable.\n\n## Changes Required\n\n### 1. Add Import (around line 10)\n```python\nfrom bootstrapper.generators.security import generate_authentication_middleware\n```\n\n### 2. Insert Generation Step\n**Location**: After `ensure_package_structure()`, before `run_openapi_generator()`\n\n**Why this location?**\n- Package structure must exist (creates Client directory)\n- Before OpenAPI generator (middleware may be imported by generated code)\n- Parallel with generate_config_files() (both generate support files)\n\n### 3. Code to Insert\n```python\n# Step 3.6: Generate AuthenticationMiddleware if security schemes defined\nwith console.status(\"[bold yellow]Analyzing security schemes...\"):\n    try:\n        auth_results = generate_authentication_middleware(\n            target_path, project_name, openapi_file=output_file.name\n        )\n    except Exception as e:\n        console.print(f\"[bold red]✗[/bold red] Failed to analyze security: {e}\")\n        raise typer.Exit(1)\n\n# Report results\nif auth_results[\"generated\"]:\n    console.print(\n        f\"[bold green]✓[/bold green] Generated AuthenticationMiddleware.swift \"\n        f\"({auth_results['reason']})\"\n    )\nelif \"already exists\" in auth_results[\"reason\"]:\n    console.print(\n        f\"[bold blue]✓[/bold blue] AuthenticationMiddleware.swift already exists (preserved)\"\n    )\n# Silent skip if no security schemes (normal/expected)\n```\n\n## Console Output Examples\n\n### With Bearer Auth (First Run)\n```\n✓ Generated AuthenticationMiddleware.swift (Created with http bearer authentication)\n```\n\n### With API Key (First Run)\n```\n✓ Generated AuthenticationMiddleware.swift (Created with api key header authentication)\n```\n\n### No Security Defined\n```\n(No output - silent skip is intentional)\n```\n\n### File Already Exists (Subsequent Run)\n```\n✓ AuthenticationMiddleware.swift already exists (preserved)\n```\n\n## Requirements\n- Import generate_authentication_middleware from security module\n- Insert after ensure_package_structure() completes\n- Add proper error handling with try/except\n- Provide user-friendly console output using Rich\n- Silent skip when no security (don't spam output)\n- Show blue message when file preserved\n\n## File to Modify\n- src/bootstrapper/main.py (add ~20 lines)\n\n## Testing\nWill be tested by integration test (separate issue)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-13T15:24:15.563009+01:00","updated_at":"2025-12-13T19:09:30.33281+01:00","closed_at":"2025-12-13T19:09:30.33281+01:00","dependencies":[{"issue_id":"swift-package-generator-based-on-openapi-ebl","depends_on_id":"swift-package-generator-based-on-openapi-dsd","type":"blocks","created_at":"2025-12-13T15:24:15.563694+01:00","created_by":"daemon"},{"issue_id":"swift-package-generator-based-on-openapi-ebl","depends_on_id":"swift-package-generator-based-on-openapi-54h","type":"blocks","created_at":"2025-12-13T15:24:15.564152+01:00","created_by":"daemon"}]}
{"id":"swift-package-generator-based-on-openapi-ek8","title":"Implement Op2: const to enum conversion","description":"Implement src/bootstrapper/transformers/op2_const_enum.py. Logic: Find all 'const' keys, capture the value, remove 'const', add 'enum: [value]'. Handles Swift OpenAPIGenerator compatibility. Use ops_base walker. Must pass tests from 8el. See plan section 5.3 Operation 2.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T18:07:46.237264+01:00","updated_at":"2025-12-12T19:00:53.559604+01:00","closed_at":"2025-12-12T19:00:53.559604+01:00","dependencies":[{"issue_id":"swift-package-generator-based-on-openapi-ek8","depends_on_id":"swift-package-generator-based-on-openapi-8el","type":"blocks","created_at":"2025-12-12T18:10:31.289802+01:00","created_by":"daemon"},{"issue_id":"swift-package-generator-based-on-openapi-ek8","depends_on_id":"swift-package-generator-based-on-openapi-dhi","type":"blocks","created_at":"2025-12-12T18:10:31.340212+01:00","created_by":"daemon"}]}
{"id":"swift-package-generator-based-on-openapi-fpo","title":"Update generate_config_files() to be format-aware for overlay","description":"## Context\nThe overlay file should have the same extension as the original OpenAPI document:\n- `.yaml`/`.yml` → `openapi-overlay.yaml`\n- `.json` → `openapi-overlay.json`\n\nCurrently `generate_config_files()` always creates `openapi-overlay.yaml`.\n\n## Changes Required\n\n### 1. Update function signature\nAdd `file_format` parameter:\n```python\ndef generate_config_files(target_dir: Path, project_name: str, file_format: str = \".yaml\") -\u003e dict[str, bool]:\n```\n\n### 2. Update templates dict\nChoose overlay template/filename based on format:\n```python\n# Determine overlay file based on format\nif file_format == \".json\":\n    overlay_filename = \"openapi-overlay.json\"\n    overlay_template = \"overlay.json.j2\"\nelse:\n    overlay_filename = \"openapi-overlay.yaml\"\n    overlay_template = \"overlay.yaml.j2\"\n\ntemplates = {\n    ...\n    overlay_filename: overlay_template,\n    ...\n}\n```\n\n## File to Modify\n- `src/bootstrapper/generators/templates.py` (modify generate_config_files function)\n\n## Caller Update Needed\nmain.py will need to pass `file_format=original_openapi.suffix` (separate issue)","status":"in_progress","priority":1,"issue_type":"task","created_at":"2025-12-13T21:23:39.468035+01:00","updated_at":"2025-12-13T21:31:39.281329+01:00","dependencies":[{"issue_id":"swift-package-generator-based-on-openapi-fpo","depends_on_id":"swift-package-generator-based-on-openapi-kn2","type":"blocks","created_at":"2025-12-13T21:23:39.468723+01:00","created_by":"daemon"}]}
{"id":"swift-package-generator-based-on-openapi-gxq","title":"Add integration test for AuthenticationMiddleware generation","description":"Add end-to-end integration test to test_integration.py to verify AuthenticationMiddleware.swift is generated during the bootstrap workflow.\n\n## Context\nTest the complete workflow: original_openapi.yaml with security schemes → bootstrap command → AuthenticationMiddleware.swift created with correct content.\n\n## Test to Add\nLocation: tests/test_integration.py\n\n### Test Function: test_bootstrap_with_bearer_auth_generates_middleware()\n\n```python\ndef test_bootstrap_with_bearer_auth_generates_middleware():\n    \"\"\"Test that bootstrapping with Bearer auth creates AuthenticationMiddleware.\"\"\"\n    with tempfile.TemporaryDirectory() as tmpdir:\n        target_dir = Path(tmpdir)\n        \n        # Create original_openapi.yaml with Bearer auth\n        (target_dir / \"original_openapi.yaml\").write_text(\"\"\"\nopenapi: 3.1.0\ninfo:\n  title: Test API\n  version: 1.0.0\ncomponents:\n  securitySchemes:\n    BearerAuth:\n      type: http\n      scheme: bearer\npaths:\n  /test:\n    get:\n      operationId: getTest\n      responses:\n        '200':\n          description: OK\n        \"\"\".strip(), encoding=\"utf-8\")\n        \n        # Run bootstrap command\n        # Note: Adjust based on how bootstrap function is called in tests\n        # May need to use CliRunner or call bootstrap() directly\n        \n        # Verify AuthenticationMiddleware was created\n        auth_file = (\n            target_dir / \"Sources\" / \"TestProjectClient\" / \"AuthenticationMiddleware.swift\"\n        )\n        assert auth_file.exists(), \"AuthenticationMiddleware.swift should be created\"\n        \n        # Verify content\n        content = auth_file.read_text(encoding=\"utf-8\")\n        assert \"AuthenticationMiddleware\" in content, \"Should contain middleware struct\"\n        assert \"Bearer\" in content, \"Should contain Bearer token logic\"\n        assert \".authorization\" in content, \"Should use Authorization header\"\n```\n\n### Additional Test (Optional): test_bootstrap_with_api_key_generates_middleware()\n\nTest API Key authentication:\n```python\ndef test_bootstrap_with_api_key_generates_middleware():\n    \"\"\"Test that bootstrapping with API Key auth creates AuthenticationMiddleware.\"\"\"\n    # Similar structure but with API Key security scheme\n    # Verify custom header name is used\n```\n\n### Additional Test (Optional): test_bootstrap_without_security_no_middleware()\n\nTest that no file is created when security schemes are absent:\n```python\ndef test_bootstrap_without_security_no_middleware():\n    \"\"\"Test that no middleware is generated when security schemes are absent.\"\"\"\n    # Create OpenAPI without security\n    # Run bootstrap\n    # Verify AuthenticationMiddleware.swift does NOT exist\n```\n\n## Requirements\n- Use existing integration test patterns from test_integration.py\n- Follow the same bootstrap invocation method used in other integration tests\n- Test with both Bearer and API Key schemes (at minimum Bearer)\n- Verify file existence and content\n- Handle both positive cases (file created) and negative cases (no security)\n\n## Testing Pattern\nThe integration tests may use:\n- Direct function call: `bootstrap(target_dir=str(target_dir), project_name=\"TestProject\")`\n- CLI runner: `runner = CliRunner(); result = runner.invoke(app, [\"bootstrap\", str(target_dir)])`\n\nFollow the pattern used in existing integration tests.\n\n## Verification\nRun integration tests with:\n```bash\nuv run pytest tests/test_integration.py::test_bootstrap_with_bearer_auth_generates_middleware -v\n```\n\nTest should pass before marking issue complete.\n\n## File to Modify\n- tests/test_integration.py (add 1-3 test functions, ~30-100 lines)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-13T15:25:08.391378+01:00","updated_at":"2025-12-13T19:15:45.877342+01:00","closed_at":"2025-12-13T19:15:45.877342+01:00","dependencies":[{"issue_id":"swift-package-generator-based-on-openapi-gxq","depends_on_id":"swift-package-generator-based-on-openapi-ebl","type":"blocks","created_at":"2025-12-13T15:25:08.392124+01:00","created_by":"daemon"}]}
{"id":"swift-package-generator-based-on-openapi-hc8","title":"Write tests for Op4: format byte to contentEncoding","description":"Write pytest tests for Op4 transformation. Test cases: (1) {type:string, format:byte} converted to {type:string, contentEncoding:base64} for OpenAPI 3.1+, (2) version check works, (3) format key removed after conversion. Use OpenAPI 3.1 spec examples. TDD approach.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T18:07:46.906029+01:00","updated_at":"2025-12-12T19:04:17.537775+01:00","closed_at":"2025-12-12T19:04:17.537775+01:00"}
{"id":"swift-package-generator-based-on-openapi-j4y","title":"Add Package.swift Jinja2 template","description":"Create src/bootstrapper/resources/Package.swift.j2 template with all Swift dependencies (OpenAPI runtime, AsyncHTTPClient, etc). This template will be used by swift.py to generate Package.swift with proper target structure (Types and Client). See plan section 5.4.2 and section 6.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T19:34:12.243616+01:00","updated_at":"2025-12-12T20:55:21.578737+01:00","closed_at":"2025-12-12T20:55:21.578737+01:00","dependencies":[{"issue_id":"swift-package-generator-based-on-openapi-j4y","depends_on_id":"swift-package-generator-based-on-openapi-1wo","type":"blocks","created_at":"2025-12-12T19:34:12.244294+01:00","created_by":"daemon"}]}
{"id":"swift-package-generator-based-on-openapi-ket","title":"Create Jinja2 templates for initial Swift files","description":"Create three new Jinja2 template files in src/bootstrapper/resources/:\n\n1. TypesFile.swift.j2 - Template for Types target initial file\n2. ClientFile.swift.j2 - Template for Client target initial file  \n3. TestsFile.swift.j2 - Template for Tests target initial file\n\n## Context\nSwift Package Manager requires at least one Swift file in each target. Currently targets only have .gitkeep files, causing swift build to fail before code generation.\n\n## Requirements\n- Files must contain ONLY safe imports (external packages, NO generated code references)\n- Must use {{ project_name }} template variable for target names\n- Include helpful comments explaining purpose and where users can add custom code\n\n## TypesFile.swift.j2 Content:\n```swift\n// {{ project_name }}Types.swift\n// Auto-generated by swift-openapi-bootstrapper\n//\n// Generated types from your OpenAPI spec will be in GeneratedSources/\n// You can add custom type extensions and utilities here.\n\nimport OpenAPIRuntime\n\n// Add your custom type extensions here\n```\n\n## ClientFile.swift.j2 Content:\n```swift\n// {{ project_name }}Client.swift\n// Auto-generated by swift-openapi-bootstrapper\n//\n// Generated client code from your OpenAPI spec will be in GeneratedSources/\n// You can add custom client utilities and helper functions here.\n\nimport OpenAPIRuntime\nimport OpenAPIAsyncHTTPClient\n\n// Add your custom client utilities here\n// After code generation, you can add helper functions that use the generated Client\n```\n\n## TestsFile.swift.j2 Content:\n```swift\n// {{ project_name }}Tests.swift\n// Auto-generated by swift-openapi-bootstrapper\n\nimport Testing\nimport {{ project_name }}Client\nimport UsefulThings\n\n// Add your tests here\n```\n\n## Critical Constraint\nDO NOT import anything from generated code (e.g., Client struct, Types) because swift-openapi-generator builds the package first. Only external package imports are safe.\n\n## Files to Create\n- src/bootstrapper/resources/TypesFile.swift.j2\n- src/bootstrapper/resources/ClientFile.swift.j2\n- src/bootstrapper/resources/TestsFile.swift.j2","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-13T14:49:26.043316+01:00","updated_at":"2025-12-13T15:38:31.453747+01:00","closed_at":"2025-12-13T15:38:31.453747+01:00"}
{"id":"swift-package-generator-based-on-openapi-kn2","title":"Create overlay.json.j2 template for JSON OpenAPI specs","description":"## Context\nThe overlay file format should match the original OpenAPI document's extension. Currently only `overlay.yaml.j2` exists.\n\n## Task\nCreate `src/bootstrapper/resources/overlay.json.j2` - a JSON equivalent of the existing YAML overlay template.\n\n## Template Content\nConvert the existing YAML template to valid JSON:\n- Same structure as overlay.yaml.j2\n- Use JSON syntax (double quotes, no comments in output)\n- Include Jinja2 variables: `{{ project_name }}`\n- Empty `actions` array by default\n\n## Reference\nSee existing template: `src/bootstrapper/resources/overlay.yaml.j2`\n\n## File to Create\n- `src/bootstrapper/resources/overlay.json.j2` (~15 lines)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-13T21:23:29.122533+01:00","updated_at":"2025-12-13T21:29:56.591988+01:00","closed_at":"2025-12-13T21:29:56.591988+01:00"}
{"id":"swift-package-generator-based-on-openapi-pbj","title":"Implement loader.py for JSON/YAML parsing","description":"Implement src/bootstrapper/core/loader.py with load_spec(path: Path) -\u003e (dict, FileFormat) function. Must detect file extension (.yaml/.json), use yaml.safe_load or json.load appropriately, and return both the parsed dict and a FileFormat enum. Handle both JSON and YAML OpenAPI specs. See plan section 5.2.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-12T18:07:44.979911+01:00","updated_at":"2025-12-12T18:33:32.291988+01:00","closed_at":"2025-12-12T18:33:32.291988+01:00"}
{"id":"swift-package-generator-based-on-openapi-r44","title":"Implement Op3: nullable to 3.1 format transformer","description":"Implement src/bootstrapper/transformers/op3_nullable.py. Logic: Check root openapi version, if \u003c3.1.0 find 'nullable:true', convert to 3.1 style (oneOf or type array with null). Remove nullable key. Use pattern Swift OpenAPIGenerator expects. Must pass tests from 08g. See plan section 5.3 Operation 3.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T18:07:46.671324+01:00","updated_at":"2025-12-12T19:03:17.808939+01:00","closed_at":"2025-12-12T19:03:17.808939+01:00","dependencies":[{"issue_id":"swift-package-generator-based-on-openapi-r44","depends_on_id":"swift-package-generator-based-on-openapi-08g","type":"blocks","created_at":"2025-12-12T18:10:31.478563+01:00","created_by":"daemon"},{"issue_id":"swift-package-generator-based-on-openapi-r44","depends_on_id":"swift-package-generator-based-on-openapi-dhi","type":"blocks","created_at":"2025-12-12T18:10:31.522508+01:00","created_by":"daemon"}]}
{"id":"swift-package-generator-based-on-openapi-ruo","title":"Refactor op3_nullable to use required array for nullability","description":"## Problem\n\nSwift OpenAPI Generator determines nullability based on whether a property is in the `required` array, NOT through:\n- `nullable: true` (OpenAPI 3.0 style)\n- `type: [string, null]` (OpenAPI 3.1 array style)\n- `oneOf: [{type: string}, {type: null}]` (oneOf style)\n\nThe current op3_nullable.py transformer incorrectly converts `nullable: true` to `oneOf` format, which Swift OpenAPI Generator doesn't understand.\n\n## Goal\n\nRefactor op3_nullable.py to:\n\n1. **Detect nullable properties** - Find properties that are nullable via any of these patterns:\n   - `nullable: true`\n   - `type: [someType, null]` or `type: [null, someType]`\n   - `oneOf`/`anyOf` containing `{type: null}`\n\n2. **Clean the schema** - Remove all null-related constructs:\n   - Remove `nullable: true`\n   - Convert `type: [string, null]` back to `type: string`\n   - Unwrap `oneOf`/`anyOf` if they only contain one real type + null\n\n3. **Update required array** - For each nullable property:\n   - Ensure the property is NOT in the parent schema's `required` array\n   - This tells Swift OpenAPI Generator the property is optional (nullable)\n\n## Example\n\n**Before (original OpenAPI 3.0):**\n```yaml\nSpeechToTextModel:\n  type: object\n  required:\n    - id\n    - description  # Currently required\n  properties:\n    id:\n      type: string\n    description:\n      type: string\n      nullable: true  # But marked nullable\n```\n\n**After transformation:**\n```yaml\nSpeechToTextModel:\n  type: object\n  required:\n    - id\n    # description removed from required\n  properties:\n    id:\n      type: string\n    description:\n      type: string\n      # nullable removed, not in required = optional in Swift\n```\n\n## Implementation Notes\n\n- This transformer needs access to parent context to modify the `required` array\n- May need to refactor to do a two-pass approach or track property paths\n- Consider interaction with op5_clean_required.py (which removes required entries for non-existent properties)\n- Update all tests in tests/ that test op3_nullable behavior\n\n## Acceptance Criteria\n\n- [ ] Nullable properties are removed from `required` arrays\n- [ ] All null type constructs are cleaned from schemas\n- [ ] Swift OpenAPI Generator can process the output without errors\n- [ ] Existing tests updated to reflect new behavior\n- [ ] Integration test with real OpenAPI spec passes","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-13T18:03:53.252322+01:00","updated_at":"2025-12-13T18:30:55.873529+01:00","closed_at":"2025-12-13T18:30:55.873529+01:00"}
{"id":"swift-package-generator-based-on-openapi-smh","title":"Add comprehensive tests for initial Swift file creation","description":"Add comprehensive test cases to tests/test_swift.py to verify the initial Swift file creation functionality.\n\n## Context\nAfter implementing create_initial_swift_files() and integrating it into ensure_package_structure(), we need comprehensive tests to verify the functionality works correctly.\n\n## Test Cases to Implement\n\n### 1. test_initial_swift_files_created\nVerify that Swift files are created with correct names in correct locations:\n- Types file: Sources/{ProjectName}Types/{ProjectName}Types.swift\n- Client file: Sources/{ProjectName}Client/{ProjectName}Client.swift\n- Tests file: Tests/{ProjectName}Tests/{ProjectName}Tests.swift\n\nAssert all three files exist after calling ensure_package_structure().\n\n### 2. test_swift_file_content\nVerify files contain expected content:\n- TypesFile: Contains 'import OpenAPIRuntime' and project_name in header\n- ClientFile: Contains 'import OpenAPIRuntime', 'import OpenAPIAsyncHTTPClient', and project_name\n- TestsFile: Contains 'import Testing', 'import {ProjectName}Client', 'import UsefulThings'\n\nUse render_template() to get expected content and compare.\n\n### 3. test_swift_files_preserved\nVerify preservation behavior:\n1. Run ensure_package_structure() - files created\n2. Modify file contents (simulate user edits)\n3. Run ensure_package_structure() again\n4. Assert files still contain user modifications (not overwritten)\n\n### 4. test_swift_files_allow_build\nVerify swift build succeeds with just initial files (before code generation):\n1. Create a temporary directory\n2. Run ensure_package_structure()\n3. Run swift build (or run_swift_build() function)\n4. Assert build succeeds\n\nNote: May need to skip if swift is not available in test environment.\n\n### 5. test_create_initial_swift_files_return_values\nTest the create_initial_swift_files() function directly:\n1. First call: Returns {\"types_file\": True, \"client_file\": True, \"tests_file\": True}\n2. Second call: Returns {\"types_file\": False, \"client_file\": False, \"tests_file\": False}\n\n### 6. test_ensure_package_structure_return_includes_files\nVerify ensure_package_structure() return dict includes new keys:\n- Assert return dict has \"types_file\", \"client_file\", \"tests_file\" keys\n- Verify values are correct based on whether files were created or existed\n\n## Test Utilities\nUse existing test patterns from test_swift.py:\n- Use pytest fixtures for temporary directories\n- Follow existing naming conventions\n- Use appropriate assertions\n\n## Code Quality\n- Add docstrings to each test explaining what it verifies\n- Use descriptive variable names\n- Follow existing code style in test_swift.py\n\n## File to Modify\n- tests/test_swift.py\n\n## Verification\nRun all tests with:\n```bash\nuv run pytest tests/test_swift.py -v\n```\n\nAll new tests should pass.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-13T14:50:41.328+01:00","updated_at":"2025-12-13T17:10:30.801092+01:00","closed_at":"2025-12-13T17:10:30.801092+01:00","dependencies":[{"issue_id":"swift-package-generator-based-on-openapi-smh","depends_on_id":"swift-package-generator-based-on-openapi-9pk","type":"blocks","created_at":"2025-12-13T14:50:41.328683+01:00","created_by":"daemon"}]}
{"id":"swift-package-generator-based-on-openapi-tfp","title":"Add create_initial_swift_files() function to swift.py","description":"Add a new helper function create_initial_swift_files() to src/bootstrapper/generators/swift.py that creates initial Swift files in each target.\n\n## Context\nThis function uses the Jinja2 templates created in the previous task to generate minimal Swift files that satisfy Swift Package Manager's requirement for at least one Swift file per target.\n\n## Function Signature\n```python\ndef create_initial_swift_files(target_dir: Path, project_name: str) -\u003e dict[str, bool]:\n    \"\"\"Create initial Swift files in each target to satisfy SPM.\n\n    Creates minimal placeholder Swift files that allow swift build to succeed\n    before code generation. Files contain only safe imports (no generated code\n    references) and are created once then preserved on updates.\n\n    Args:\n        target_dir: The package root directory\n        project_name: The name of the Swift package\n\n    Returns:\n        Dictionary indicating which files were created:\n        - \"types_file\": True if created, False if existed\n        - \"client_file\": True if created, False if existed\n        - \"tests_file\": True if created, False if existed\n    \"\"\"\n```\n\n## Implementation Requirements\n1. Import render_template and write_if_not_exists from bootstrapper.generators.templates\n2. Create context dict with project_name\n3. For each target (Types, Client, Tests):\n   - Build file path: target_dir / \"Sources\" or \"Tests\" / f\"{project_name}TargetName\" / f\"{project_name}TargetName.swift\"\n   - Render template using render_template()\n   - Write using write_if_not_exists() to preserve user edits\n   - Store result in return dict\n4. Return dict with keys: \"types_file\", \"client_file\", \"tests_file\"\n\n## File Paths Generated\n- Types: Sources/{ProjectName}Types/{ProjectName}Types.swift\n- Client: Sources/{ProjectName}Client/{ProjectName}Client.swift\n- Tests: Tests/{ProjectName}Tests/{ProjectName}Tests.swift\n\n## Templates Used\n- TypesFile.swift.j2\n- ClientFile.swift.j2\n- TestsFile.swift.j2\n\n## Preservation Strategy\nUse write_if_not_exists() so files are created once and never overwritten, allowing users to add custom code safely.\n\n## File to Modify\n- src/bootstrapper/generators/swift.py (add function after line 72, before run_swift_build())","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-13T14:50:07.717691+01:00","updated_at":"2025-12-13T16:05:12.730055+01:00","closed_at":"2025-12-13T16:05:12.730055+01:00","dependencies":[{"issue_id":"swift-package-generator-based-on-openapi-tfp","depends_on_id":"swift-package-generator-based-on-openapi-ket","type":"blocks","created_at":"2025-12-13T14:50:07.718469+01:00","created_by":"daemon"}]}
{"id":"swift-package-generator-based-on-openapi-uwe","title":"Add tests for overlay application","description":"## Context\nAdd comprehensive tests for the overlay application functionality.\n\n## Test File\n`tests/test_overlay.py` (new file) or add to `tests/test_transformers.py`\n\n## Test Cases for apply_overlay()\n\n### 1. test_overlay_file_not_exists\n- No overlay file present\n- Returns `{\"applied\": False, \"skipped\": True, \"reason\": \"No overlay file found\"}`\n\n### 2. test_overlay_empty_actions\n- Overlay file exists with `actions: []`\n- Returns `{\"applied\": False, \"skipped\": True, \"reason\": \"Overlay has no actions defined\"}`\n\n### 3. test_overlay_applied_yaml\n- YAML overlay file with actions\n- Mock or skip if openapi-format not installed\n- Verify overlay is applied to openapi.yaml\n- Returns `{\"applied\": True, ...}`\n\n### 4. test_overlay_applied_json\n- JSON overlay file with actions\n- Verify overlay is applied to openapi.json\n\n### 5. test_overlay_openapi_format_not_found\n- Overlay has actions but openapi-format not in PATH\n- Returns helpful error message about installation\n\n### 6. test_overlay_derives_correct_filename\n- openapi.yaml → looks for openapi-overlay.yaml\n- openapi.json → looks for openapi-overlay.json\n- openapi.yml → looks for openapi-overlay.yml\n\n## Test Cases for generate_config_files() format awareness\n\n### 7. test_config_files_creates_yaml_overlay\n- Pass `file_format=\".yaml\"`\n- Creates `openapi-overlay.yaml`\n\n### 8. test_config_files_creates_json_overlay\n- Pass `file_format=\".json\"`\n- Creates `openapi-overlay.json`\n\n## Test Utilities\n- Use `tempfile.TemporaryDirectory()` for isolation\n- Create sample OpenAPI specs and overlay files\n- May need to mock subprocess for openapi-format tests\n- Use `pytest.mark.skipif` if openapi-format not available\n\n## Verification\n```bash\nuv run pytest tests/test_overlay.py -v\n# or\nuv run pytest tests/test_transformers.py -v -k overlay\n```","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-13T21:24:19.813319+01:00","updated_at":"2025-12-13T21:24:19.813319+01:00","dependencies":[{"issue_id":"swift-package-generator-based-on-openapi-uwe","depends_on_id":"swift-package-generator-based-on-openapi-dmp","type":"blocks","created_at":"2025-12-13T21:24:19.814132+01:00","created_by":"daemon"},{"issue_id":"swift-package-generator-based-on-openapi-uwe","depends_on_id":"swift-package-generator-based-on-openapi-apd","type":"blocks","created_at":"2025-12-13T21:24:19.814657+01:00","created_by":"daemon"}]}
{"id":"swift-package-generator-based-on-openapi-vgu","title":"Write integration tests for full pipeline","description":"Write integration tests in tests/test_integration.py. Test full pipeline: (1) Create test folder with sample broken OpenAPI spec, (2) Run CLI bootstrap command, (3) Verify all files created (Package.swift, openapi.yaml, configs, etc), (4) Verify transformations applied correctly, (5) Test update scenario (re-run with new spec). See plan section 6-7.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-12T18:07:49.104013+01:00","updated_at":"2025-12-12T22:33:27.799189+01:00","closed_at":"2025-12-12T22:33:27.799189+01:00","dependencies":[{"issue_id":"swift-package-generator-based-on-openapi-vgu","depends_on_id":"swift-package-generator-based-on-openapi-d16","type":"blocks","created_at":"2025-12-12T18:10:32.811825+01:00","created_by":"daemon"}]}
{"id":"swift-package-generator-based-on-openapi-zve","title":"Write tests for Op1: null anyOf removal","description":"Write pytest tests for Op1 transformation in tests/test_transformers.py. Test cases: (1) anyOf with type:null is removed, (2) anyOf with 1 item left is unwrapped, (3) default:null is removed when type no longer nullable. Use sample OpenAPI snippets showing before/after. Follow TDD approach - write tests BEFORE implementation.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-12T18:07:45.592856+01:00","updated_at":"2025-12-12T18:57:24.863775+01:00","closed_at":"2025-12-12T18:57:24.863775+01:00"}
